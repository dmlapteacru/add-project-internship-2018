<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Invoices page</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/header.css"/>
    <link rel="stylesheet" href="/css/table-filter.css">
    <link rel="stylesheet" href="/css/alert.css">

    <link rel="stylesheet" href="/css/invoices_customer.css">
    <link rel="stylesheet" href="/css/custom_radio_buttons.css">
    <script src="/webjars/jquery/3.1.0/jquery.min.js"></script>
    <script src="/webjars/sockjs-client/1.0.2/sockjs.min.js"></script>
    <script src="/webjars/stomp-websocket/2.3.3/stomp.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/all.js" integrity="sha384-xymdQtn1n3lH2wcu0qhcdaOpQwyoarkgLVxC/wZ5q7h9gHtxICrpcaSUfygqZGOe" crossorigin="anonymous"></script>
    <script src="/js/table-filter.js"></script>
</head>

<body>
<div class="modal fade" id="load_icon_wrapper" data-backdrop="static" data-keyboard="false">
    <img id="load" src="/img/load_icon.gif"/>
</div>

<div class="wrapper">
    <div th:replace="fragments/header :: header"></div>
    <div class="content_wrapper">
        <div class="filter_wrapper">
            <div class="filter_title">
                <span>FILTERS</span>
                <a th:href="@{/customer/invoices}"
                   class="default_btn"><span class="btn_icon_left"><i class="fas fa-eraser"></i></span><span>Clear all filters</span></a>
            </div>
            <div class="filter_content">
                <form class="filter_form"
                      th:object="${filter}"
                      th:action="@{/customer/invoices/filtered}"
                      method="post">
                    <div class="filter_form_status filter_item">
                        <label for="adv_filter_status">Status</label>
                        <select id="adv_filter_status" class="form-control input-sm input-br-head" th:field="*{invoiceStatus}">
                            <option value="">Select invoice status</option>
                            <option th:each="currStatus : ${statusListForFilter}"
                                    th:value="${currStatus.name()}"
                                    th:text="${currStatus.toString()}">
                            </option>
                        </select>
                    </div>
                    <div class="filter_form_range_sum filter_item">
                        <div class="sum_input">
                            <label for="adv_filter_sumFrom">Sum from</label>
                            <input class="form-control input-sm input-br-head" id="adv_filter_sumFrom" type="number"
                                   th:field="*{sumFrom}"
                                   placeholder="sum from" required/>
                        </div>
                        <div class="sum_input">
                            <label for="adv_filter_sumTo">Sum to</label>
                            <input class="form-control input-sm input-br-head" id="adv_filter_sumTo" type="number"
                                   th:field="*{sumTo}"
                                   placeholder="sum to" required/>
                        </div>
                    </div>
                    <div class="filter_form_range_date filter_item">
                        <div class="date_input">
                            <label for="adv_filter_date_from">Date from</label>
                            <input type="date" id="adv_filter_date_from" class="form-control input-sm input-br-head"
                                   th:field="*{dateFrom}"/>
                        </div>
                        <div class="date_input">
                            <label for="adv_filter_date_to">Date to</label>
                            <input type="date" id="adv_filter_date_to" class="form-control input-sm input-br-head"
                                   th:field="*{dateTo}"/>
                        </div>
                    </div>
                    <div class="filter_item">
                        <button type="submit" class="btn_apply"><span>Apply</span>
                            <span class="btn_icon_right"><i class="fas fa-check"></i></span>
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div class="filterable">
            <!--<div class="panel-heading">-->
                <!--&lt;!&ndash;<h3 class="panel-title" style="visibility: hidden">INVOICES</h3>&ndash;&gt;-->
                <!--<div class="pull-right">-->
                    <!--<button class="btn btn-default btn-xs btn-filter"><span class="glyphicon glyphicon-filter"></span> Search-->
                    <!--</button>-->
                <!--</div>-->
            <!--</div>-->
            <table class="table">
                <thead>
                <div class="bulk_btn_wrapper" style="display: none;">
                    <span>TOTAL SUM TO PAY: <span id="bulk_pay_sum"
                                   style="font-size:16px;font-weight: bold;border: 1px solid #ddd; padding: 5px; border-radius: 3px;"></span> MDL</span>
                    <a id="bulk_pay_btn" class="btn_pay">BULK PAYMENT</a>
                </div>
                <tr class="filters">
                    <th>
                        <div class="checkbox_users_wrapper">
                            <label class="control control--radio">
                                <input type="checkbox" id="check_all_invoices"/>
                                <div class="control__indicator"></div>
                            </label>
                            <span>Choose to pay all invoices</span>
                        </div>
                    </th>
                    <!--<th><input type="text" class="form-control" placeholder="ISSUE DATE" disabled></th>-->
                    <!--<th><input type="text" class="form-control" placeholder="EXPIRE DATE" disabled></th>-->
                    <!--<th><input type="text" class="form-control" placeholder="SUM" disabled></th>-->
                    <!--<th>-->
                        <!--<select class="sel_status_invoice" disabled>-->
                            <!--<option selected value="Status_INV">STATUS</option>-->
                            <!--<option>PAID</option>-->
                            <!--<option>SENT</option>-->
                            <!--<option>OVERDUE</option>-->
                        <!--</select>-->
                    <!--</th>-->
                    <!--<th><input type="text" class="form-control" placeholder="COMPANY" disabled></th>-->
                    <!--<th><input type="text" class="form-control" placeholder="SERVICE" disabled></th>-->
                    <th></th>
                </tr>
                </thead>
                <tbody class="filter_body">
                <tr th:each="invoice: ${invoices}" th:id="'row' + ${invoice.getId()}">
                    <td width="3%">
                        <label class="control control--radio"  th:if="${invoice.status}!=${invoice.status.PAID}">
                            <input type="checkbox" name="choice"  th:value="${invoice.id}" class="checkbox_invoice_element"/>
                            <div class="control__indicator"></div>
                        </label>
                    </td>
                    <td id="invoice_date"><span th:text="${#temporals.format(invoice.issueDate, 'dd-MM-yyyy')}"></span><br><span class="sub_label">ISSUE DATE</span></td>
                    <td><span th:text="${#temporals.format(invoice.dueDate, 'dd-MM-yyyy')}"></span><br><span class="sub_label">EXPIRE DATE</span></td>
                    <td><span id="sum_to_pay" th:text="${invoice.sum}"></span><span> MDL</span></td>
                    <td><span class="filter_status_invoice" th:text="${invoice.getStatus()}"></span></td>
                    <td><span th:text="${invoice.getContract().getCompany().getName()}"></span><br><span class="sub_label">COMPANY NAME</span></td>
                    <td><span th:text="${invoice.getContract().getProduct().getName()}"></span><br><span class="sub_label">SERVICE NAME</span></td>
                    <td>
                        <button th:if="${invoice.getStatus()}!=${invoice.status.PAID}" th:id="${invoice.getId()}"
                                class="btn_pay" onclick="payInvoice(this)">PAY INVOICE
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<div id="alert_success" class="alert alert-success alert-dismissible fade in">
    <div id="approval_info">
        <strong id="confirm_alert_message"></strong>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
</div>
<div id="alert_error" class="alert alert-danger alert-dismissible fade in">
    <div id="alert_error_info">
        <strong id="error_alert_message"></strong>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
</div>
<script src="/js/loadbalance.js"></script>
<script src="/js/user-websock.js"></script>
<script src="/js/customer-sock-distribute.js"></script>
<script src="/js/invoice-payment.js"></script>
</body>
</html>
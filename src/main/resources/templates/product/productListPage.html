<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">

<head>
    <title>Services</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/table-filter.css"/>
    <!--<link rel="stylesheet" type="text/css" href="/css/admin.css"/>-->
    <link rel="stylesheet" type="text/css" href="/css/header.css"/>
    <link rel="stylesheet" type="text/css" href="/css/services.css"/>
    <link rel="stylesheet" type="text/css" href="/css/custom_radio_buttons.css"/>
    <script src="/webjars/jquery/3.1.0/jquery.min.js"></script>
    <script src="/webjars/sockjs-client/1.0.2/sockjs.min.js"></script>
    <script src="/webjars/stomp-websocket/2.3.3/stomp.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/all.js"
            integrity="sha384-xymdQtn1n3lH2wcu0qhcdaOpQwyoarkgLVxC/wZ5q7h9gHtxICrpcaSUfygqZGOe"
            crossorigin="anonymous"></script>
    <script src="/js/table-filter.js"></script>
</head>

<body>
<div class="modal fade" id="load_icon_wrapper" data-backdrop="static" data-keyboard="false">
    <img id="load" src="/img/load_icon.gif"/>
</div>
<div class="wrapper">
    <div th:replace="fragments/header :: header"></div>
    <div class="page_title">
        <div class="title">
            <span>Services</span>
        </div>
        <div class="description">
            <span>Here you can find list of services available and choose any of them.</span>
        </div>
    </div>
    <div class="content_wrapper">
        <div class="filter_wrapper">
            <div class="filter_title">
                <span>FILTERS</span>
                <a th:href="${ownerType=='customer'} ? @{/customer/services} : @{/company/services}"
                   class="default_btn"><span class="btn_icon_left"><i class="fas fa-eraser"></i></span><span>Clear all filters</span></a>
            </div>
            <div class="filter_content">
                <form class="filter_form" th:object="${filter}" method="post"
                      th:action="${ownerType=='customer'} ? @{/customer/services/filtered} : @{/company/services/filtered}">
                    <div class="form-row">
                        <div class="filter_form_range_sum filter_item">
                            <div class="sum_input">
                                <label for="adv_filter_sumFrom">Sum from</label>
                                <input class="form-control input-sm input-br-head" id="adv_filter_sumFrom" type="number"
                                       th:field="*{sumFrom}"
                                       placeholder="sum from" required/>
                            </div>
                            <div class="sum_input">
                                <label for="adv_filter_sumTo">Sum to</label>
                                <input class="form-control input-sm input-br-head" id="adv_filter_sumTo" type="number"
                                       th:field="*{sumTo}"
                                       placeholder="sum to" required/>
                            </div>
                        </div>
                        <div class="filter_item">
                            <button type="submit" class="btn_apply"><span>Apply</span>
                                <span class="btn_icon_right"><i class="fas fa-check"></i></span>
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div class="filterable">
            <div class="panel-heading">
                <!--<h3 class="panel-title">Services</h3>-->
                <button sec:authorize="hasAuthority('COMPANY')" data-toggle="modal" data-target="#modalService"
                   data-backdrop="static"
                   class="btn_create_service" role="button" onclick="getCategories()">
                    <div>
                        <span class="btn_icon_left"><i class="fas fa-plus-circle"></i></span>
                        <span>NEW SERVICE</span>
                    </div>
                </button>
                <div sec:authorize="hasAuthority('CUSTOMER')" class="dropdown pull-left">
                    <button class="btn_pay dropdown-toggle" type="button" id="priceListMenu" data-toggle="dropdown" title="Choose Services">
                        <span class="btn_icon_left"><i class="fas fa-download"></i></span>
                        <span>PDF</span>
                        <span class="caret"></span></button>
                    <ul class="dropdown-menu dropdown-menu-left dropdown_action" role="menu" aria-labelledby="priceListMenu">
                        <li role="presentation">
                            <a role="menuitem" tabindex="-1"
                               th:href="@{/productRest/pdfExport(products=null)}">
                                <span class="btn_icon_left"><i class="fas fa-clipboard-list"></i></span>
                                <span>ALL SERVICES</span>
                            </a>
                        </li>
                        <li role="presentation">
                            <a role="menuitem" tabindex="-1"
                               onclick="getPriceListAsPDF()">
                                <span class="btn_icon_left"><i class="fas fa-clipboard-check"></i></span>
                                <span>SELECTED SERVICES</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="pull-right">
                    <button class="btn btn-default btn-xs btn-filter"><span class="glyphicon glyphicon-filter"></span> Search
                    </button>
                </div>
            </div>
            <input type="hidden" id="customerId" th:value="${customerId}">
            <input type="hidden" id="customerName" th:value="${customerName}">
            <table class="table">
                <thead>
                <tr class="filters">
                    <th width="5%" class="pdf_error_checked" sec:authorize="hasAuthority('CUSTOMER')">
                        <div class="pdf_error_message">Please choose services.</div>
                    </th>
                    <th>
                        <select class="form-control sel_category" id="selectFilter" disabled>
                            <option selected value="Category">Category</option>
                            <option th:each="category : ${categoryList}"
                                    th:text="${category.getName()}">
                            </option>
                        </select>
                    </th>
                    <th><input type="text" class="form-control" placeholder="Name" disabled></th>
                    <th sec:authorize="hasAuthority('CUSTOMER')">
                        <input type="text" class="form-control" placeholder="Company" disabled>
                    </th>
                    <th><input type="text" class="form-control" placeholder="Price" disabled></th>
                    <th width="30%" align="left"><input type="text" class="form-control" placeholder="Description" disabled></th>
                    <th width="17%"></th>
                </tr>
                </thead>
                <tbody class="filter_body">
                <tr th:each="product : ${products}" th:id="'row'+${product.getId()}">

                    <td width="5%" sec:authorize="hasAuthority('CUSTOMER')">
                        <label class="control control--radio">
                            <input type="checkbox" name="choice" th:value="${product.getId()}"/>
                            <div class="control__indicator"></div>
                        </label>
                    </td>

                    <td class="filter_category" th:id="categoryId" th:value="${product.getCategory().getId()}"
                        th:text="${product.getCategory().getName()}">category
                    </td>
                    <td th:id="productId" th:value="${product.getId()}"
                        th:text="${product.getName()}">name
                    </td>
                    <td sec:authorize="hasAuthority('CUSTOMER')" th:id="companyId"
                        th:value="${product.getCompany().getId()}"
                        th:text="${product.getCompany().getName()}">company
                    </td>
                    <td class="currency money" th:id="sum" th:value="${product.getPrice()}"
                        th:text="${#numbers.formatDecimal(product.getPrice(),1,2)}+' MDL'">price
                    </td>
                    <td width="30%" th:id="description" th:value="${product.getDescription()}"
                        th:text="${product.getDescription()}">description
                    </td>

                    <td width="17%">
                        <button sec:authorize="hasAuthority('CUSTOMER')" data-toggle="modal" data-target="#modalContract"
                           class="btn_create_contract" role="button" th:id="${product.getId()}" data-backdrop="static"
                           onclick="createNewContract(this)">CREATE CONTRACT</button>
                        <div class="dropdown" sec:authorize="hasAuthority('COMPANY')">
                            <a class="dropdown-toggle" type="button" id="menu1" data-toggle="dropdown" title="Actions..">
                                <span class="dot_3"><i class="fas fa-ellipsis-h"></i></span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-right dropdown_action" role="menu" aria-labelledby="menu1">
                                <li role="presentation">
                                    <a sec:authorize="hasAuthority('COMPANY')" data-toggle="modal" data-target="#modalDescription"
                                            role="button" th:id="${product.getId()}" data-backdrop="static"
                                            onclick="updateProduct(this)">
                                        <span class="btn_icon_left"><i class="fas fa-pencil-alt"></i></span>
                                        <span>UPDATE</span>
                                    </a>
                                </li>
                                <li role="presentation">
                                    <a sec:authorize="hasAuthority('COMPANY')" data-toggle="modal" data-target="#modalDeleteConfirm"
                                            role="button" th:id="'btn_delete_'+${product.getId()}"
                                            onclick="deleteService(this)" data-backdrop="static">
                                        <span class="btn_icon_left"><i class="fas fa-trash-alt"></i></span>
                                        <span>DELETE</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </td>

                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>


<div class="modal fade" id="modalService" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Service details:</h4>
            </div>
            <div class="modal-body modal_body_category">

                <form class="form-horizontal">

                    <p id="company_id" sec:authorize="hasAuthority('COMPANY')"
                       th:text="${companyId}" style="display: none"></p>
                    <!--<input id="new_category_id" type="text" hidden="hidden"/>-->

                    <div class="form-group">
                        <label class="col-sm-3 control-label">Category</label>
                        <div class="col-sm-7">
                            <select id="select_category" class="form-control">
                                <option id="0">--select--</option>
                            </select>
                            <p id="select_categoryError" style="color: red; display: none"> validation error</p>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-3 control-label">Name</label>
                        <div class="col-sm-7">
                            <input id="new_service_name" class="form-control" type="text" required="required"/>
                            <p id="new_service_nameError" style="color: red; display: none"> validation error</p>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-3 control-label">Price</label>
                        <div class="col-sm-7">
                            <input id="new_service_price" class="form-control" type="number" min="0" step="0.01"
                                   value="0.00"
                                   required="required"/>
                            <p id="new_service_priceError" style="color: red;display: none"> validation error</p>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-3 control-label">Description</label>
                        <div class="col-sm-7">
                            <textarea id="new_service_desc" class="form-control" required="required"></textarea>
                            <p id="new_service_descError" style="color: red; display: none"> validation error</p>
                        </div>
                    </div>

                    <p id="error_service" style="color: red"></p>
                    <div class="form-group">
                        <div class="col-sm-7 col-xs-offset-3">
                            <button type="button" style="display: none;" class="btn"></button>
                            <button id="save_btn_service" type="submit" class="btn btn-success">Save</button>
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalDescription" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Update service description:</h4>
            </div>
            <div class="modal-body modal_body_category">

                <form class="form-horizontal">

                    <input type="text" hidden="hidden" id="upd_service_id">

                    <div class="form-group">
                        <label class="col-sm-3 control-label" for="upd_service_desc">Description</label>
                        <div class="col-sm-7">
                            <textarea id="upd_service_desc" class="form-control" required="required"></textarea>
                            <p id="upd_service_descError" style="color: red; display: none"> validation error</p>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-sm-7 col-xs-offset-3">
                            <button type="button" style="display: none;" class="btn"></button>
                            <button id="upd_btn_service" type="submit" class="btn btn-success">Save</button>
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalContract" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Contract details</h4>
            </div>
            <div class="modal-body">
                <form class="form-horizontal">

                    <div class="form-group">
                        <label class="col-sm-3 control-label">Issue date</label>
                        <div class="col-sm-6">
                            <input type="date" class="form-control" id="new_issueDate" required="required"/>
                            <p class="error-message" id="new_issueDateError" style="display: none"> validation error</p>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-3 control-label">Expire date</label>
                        <div class="col-sm-6">
                            <input type="date" class="form-control" id="new_expireDate" required="required"/>
                            <p class="error-message" id="new_expireDateError" style="display: none">validation error</p>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-3 control-label">Customer</label>
                        <div class="col-sm-6">
                            <input type="text" class="form-control" id="new_customer" value="" readonly/>
                            <input type="hidden" class="form-control" id="new_customerId"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-3 control-label">Company</label>
                        <div class="col-sm-6">
                            <input type="text" class="form-control" id="new_company" readonly/>
                            <input type="hidden" class="form-control" id="new_companyId"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-3 control-label">Service</label>
                        <div class="col-sm-6">
                            <input type="text" class="form-control" id="new_product" value="" readonly/>
                            <input type="hidden" class="form-control" id="new_productId"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-3 control-label">Sum</label>
                        <div class="col-sm-6">
                            <input type="number" class="form-control" id="new_sum" readonly/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-3 control-label">Signature</label>
                        <div class="col-sm-6">
                            <select class="form-control" id="new_status">
                                <option selected>Signed</option>
                                <option>Unsigned</option>
                            </select>
                        </div>
                    </div>

                    <div class="alert-warning">
                        <span id="new_contractError" style="display: none">validation error</span>
                    </div>

                    <div class="form-group">
                        <div class="col-sm-6 col-xs-offset-3">
                            <button type="submit" id="btn_save_contract" class="btn btn-info">Save</button>
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </form>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalAlert" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"
                        onclick="location.reload()">&times;
                </button>
                <h4 id="alertTitle"></h4>
            </div>
            <div class="modal-body">

            </div>
            <div class="modal-footer modal_btn">
                <button type="button" class="btn btn-default" data-dismiss="modal"
                        onclick="location.reload()">Close
                </button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalDeleteConfirm" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title"></h4>
            </div>
            <div class="modal-body">
                <input id="deleteProductId" type="text" hidden="hidden"/>
            </div>
            <div class="modal-footer modal_btn">
                <button id="btn_delete_product" type="button" class="btn btn-warning">Delete</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

</body>

<script src="/js/user-websock.js"></script>
<script src="/js/customer-sock-distribute.js"></script>
<script src="/js/loadbalance.js"></script>
<script>
    function getCategories() {
        clearErrors();
        $("#new_service_name").val("");
        $("#new_service_desc").val("");
        $("#new_service_price").val("0.0");
        $('#select_category').find('option').each(function () {
            if ($(this).text() !== '--select--') {
                $(this).remove();
            }
        });
        $("#save_btn_service").attr("disabled", false);
        $.ajax(
            {
                url: "/categories",
                success: function (result) {
                    loadCategories(result);
                }
            }
        )
    }

    function deleteService(btn) {
        var productId = btn.id.substring(11);
        var row = $('#row' + productId);
        var modalConfirm = $('#modalDeleteConfirm');
        modalConfirm.find('.modal-title').text('Are you sure to delete the service?');
        var modalBody = modalConfirm.find('.modal-body');
        modalBody.find('p').empty();
        modalBody.append('<p>Category: ' + row.find('#categoryId').text() + '</p>');
        modalBody.append('<p>Name: ' + row.find('#productId').text() + '</p>');
        modalBody.append('<p>Price: ' + row.find('#sum').text() + '</p>');
        modalBody.append('<p>Description: ' + row.find('#description').text() + '</p>');
        $('#deleteProductId').val(productId);
        $("#btn_delete_product").attr("disabled", false);
    }

    function showAlert(title, message) {
        var alertWindow = $('#modalAlert');
        $('#alertTitle').text(title);
        var alertBody = alertWindow.find('.modal-body');
        alertBody.find('p').empty();
        var strings = message.split('\n');
        for (i = 0; i < strings.length; i++) {
            alertBody.append('<p>' + strings[i] + '</p>');
        }
        alertWindow.modal({backdrop: "static"});
        alertWindow.modal('show');
    }

    $('#btn_delete_product').click(function () {
        $("#btn_delete_product").attr("disabled", true);
        $.ajax(
            {
                url: "/productRest/deleteProduct",
                type: "POST",
                data: {"productId": $('#deleteProductId').val()},
                 success: function () {
                    $("#modalDeleteConfirm").modal("hide");
                    showAlert('Service was deleted', '');
                },
                error: function (result) {
                    $("#modalDeleteConfirm").modal("hide");
                    showAlert('Service can not be deleted', result.responseText);
                }
            }
        )
    });

    function updateProduct(btn) {
        clearErrors();
        var row = $("#row" + btn.id);
        $('#upd_service_id').val(btn.id);
        $('#upd_service_desc').text(row.find('#description').text());
        $("#upd_btn_service").attr("disabled", false);
    }

    $("#upd_btn_service").click(function (event) {
        event.preventDefault();
        $("#upd_btn_service").attr("disabled", true);
        var updServiceData = {
            "productId": $('#upd_service_id').val(),
            "description": $("#upd_service_desc").val()
        };
        $.ajax(
            {
                url: "/productRest/updateProduct",
                type: "post",
                contentType: "application/json",
                data: JSON.stringify(updServiceData),
                success: function (response) {
                    if (response.status === 'FAIL') {
                        var allErrors = response.errorMessageList;
                        for (i = 0; i < allErrors.length; i++) {
                            var currFieldName = allErrors[i].fieldName;
                            $('#' + currFieldName).parent().addClass('has-error');
                            $('#' + currFieldName + 'Error').text(allErrors[i].message);
                            $('#' + currFieldName + 'Error').show();
                        }
                    } else {
                        $('#modalDescription').modal('hide');
                        location.reload();
                    }
                },
                error: function (exception) {
                    alert('Error: ' + exception);
                }
            }
        )
    });

    function loadCategories(data) {
        $.each(data, function (id, object) {
            var categoryID = object.id;
            $.each(object, function (key, value) {
                if (key == "name") {
                    $("#select_category").append("<option id='" + categoryID + "'>" + value + "</option>")
                }
            });
        });
    }

    $("#save_btn_service").click(function (event) {
        event.preventDefault();
        $("#save_btn_service").attr("disabled", true);
        var newServiceData = {
            "name": $("#new_service_name").val(),
            "price": $("#new_service_price").val(),
            "companyId": $("#company_id").text(),
            "categoryId": $("#select_category").children(":selected").attr("id"),
            "description": $("#new_service_desc").val()
        };
        $.ajax(
            {
                url: "/productRest/newProduct",
                type: "post",
                contentType: "application/json",
                data: JSON.stringify(newServiceData),
                success: function (response) {
                    if (response.status === 'FAIL') {
                        var allErrors = response.errorMessageList;
                        for (i = 0; i < allErrors.length; i++) {
                            var currFieldName = allErrors[i].fieldName;
                            $('#' + currFieldName).parent().addClass('has-error');
                            $('#' + currFieldName + 'Error').text(allErrors[i].message);
                            $('#' + currFieldName + 'Error').show();
                        }
                    } else {
                        $('#modalService').modal('hide');
                        location.reload();
                    }
                },
                error: function (exception) {
                    alert('Error: ' + exception);
                }
            }
        )
    });

    function createNewContract(btn) {
        clearErrors();
        var row = $("#row" + btn.id);
        var now = new Date();
        var day = ("0" + now.getDate()).slice(-2);
        var month = ("0" + (now.getMonth() + 1)).slice(-2);
        var today = now.getFullYear() + "-" + (month) + "-" + (day);
        $('#new_issueDate').val(today);
        $('#new_expireDate').val(null);
        $('#new_customer').val($('#customerName').val());
        $('#new_customerId').val($("#customerId").val());
        $('#new_company').val(row.find("#companyId").text());
        $('#new_companyId').val(row.find("#companyId").attr('value'));
        $('#new_product').val(row.find("#productId").text());
        $('#new_productId').val(row.find("#productId").attr('value'));
        $('#new_sum').val(row.find("#sum").attr('value'));
        $("#btn_save_contract").attr("disabled", false);
    }

    $("#btn_save_contract").click(function (event) {
        event.preventDefault();
        $("#btn_save_contract").attr("disabled", true);
        $('#alertTitle').text('');
        var newContractData = {
            "issueDate": $("#new_issueDate").val(),
            "expireDate": $("#new_expireDate").val(),
            "sum": $("#new_sum").val(),
            "status": ($("#new_status").val() === 'Signed' ? "SIGNED_BY_CUSTOMER" : "UNSIGNED"),
            "companyId": $("#new_companyId").val(),
            "customerId": $("#new_customerId").val(),
            "productId": $("#new_productId").val()
        }
        $.ajax(
            {
                url: "/contractRest/newContract",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify(newContractData),
                success: function (response) {
                    if (response.status === 'FAIL') {
                        var allErrors = response.errorMessageList;
                        for (i = 0; i < allErrors.length; i++) {
                            var currFieldName = allErrors[i].fieldName;
                            var currErrorMessage = allErrors[i].message;
                            $('#' + currFieldName).parent().addClass('has-error');
                            $('#' + currFieldName + 'Error').text(currErrorMessage);
                            $('#' + currFieldName + 'Error').show();
                        }
                    } else {
                        $('#modalContract').modal('hide');
                        $('#alertTitle').text('New contract was added successful');
                        $('#modalAlert').modal('show');
                    }
                },
                error: function (exception) {
                    alert('Error: ' + exception);
                }
            }
        )
    });

    function clearErrors() {
        $('#new_issueDate').focus(function () {
            $('#new_issueDate').parent().removeClass('has-error');
            $('#new_issueDateError').hide();
            $("#btn_save_contract").attr("disabled", false);
        });
        $('#new_expireDate').focus(function () {
            $('#new_expireDate').parent().removeClass('has-error');
            $('#new_expireDateError').hide();
            $("#btn_save_contract").attr("disabled", false);
        });
        $('#new_service_name').focus(function () {
            $('#new_service_name').parent().removeClass('has-error');
            $('#new_service_nameError').hide();
            $("#save_btn_service").attr("disabled", false);
        });
        $('#new_service_price').focus(function () {
            $('#new_service_price').parent().removeClass('has-error');
            $('#new_service_priceError').hide();
            $("#save_btn_service").attr("disabled", false);
        });
        $('#new_service_desc').focus(function () {
            $('#new_service_desc').parent().removeClass('has-error');
            $('#new_service_descError').hide();
            $("#save_btn_service").attr("disabled", false);
        });
        $('#select_category').focus(function () {
            $('#select_category').parent().removeClass('has-error');
            $('#select_categoryError').hide();
            $("#save_btn_service").attr("disabled", false);
        });
        $('#upd_service_desc').focus(function () {
            $('#upd_service_desc').parent().removeClass('has-error');
            $('#upd_service_descError').hide();
            $("#upd_btn_service").attr("disabled", false);
        });
        $('#new_issueDate').parent().removeClass('has-error');
        $('#new_issueDateError').hide();
        $('#new_expireDate').parent().removeClass('has-error');
        $('#new_expireDateError').hide();
        $('#new_service_name').parent().removeClass('has-error');
        $('#new_service_nameError').hide();
        $('#new_service_price').parent().removeClass('has-error');
        $('#new_service_priceError').hide();
        $('#new_service_desc').parent().removeClass('has-error');
        $('#new_service_descError').hide();
        $('#select_category').parent().removeClass('has-error');
        $('#select_categoryError').hide();
        $('#upd_service_desc').parent().removeClass('has-error');
        $('#upd_service_descError').hide();
    }

    function getPriceListAsPDF() {
        var isChecked = false;
        $.each($(".table input:checkbox"), function () {
            if ($(this).prop("checked") === true) {
                isChecked = true;
            }
        });

        if (isChecked === false){
            $(".pdf_error_message").slideToggle("slow");
            setTimeout(function () {
                $(".pdf_error_message").slideToggle("slow");
            }, 2000);
        } else {
            var productIds = [];
            $(".table input:checkbox:checked").each(function () {
                productIds.push($(this).val());
            });
            $("#load_icon_wrapper").modal("show");
            window.location = '/productRest/pdfExport?products=' + productIds;
        }

    }

</script>
<script>$(".i_services").addClass("active_menu_link");</script>

</html>